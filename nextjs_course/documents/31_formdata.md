# ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞ FormData ‡πÉ‡∏ô Next.js 15.3.2

## üìã Overview

‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô Next.js ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ FormData ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå ‡πÇ‡∏î‡∏¢‡∏à‡∏∞‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á component, ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡∏ù‡∏±‡πà‡∏á server, ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

## üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢

- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ preview ‡πÑ‡∏î‡πâ
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö FormData ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå
- ‡∏™‡∏£‡πâ‡∏≤‡∏á validation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå
- ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö UI/UX ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢

## üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏Å‡πà‡∏≤

### ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡∏°‡πà (2025 / Next.js 15.3.2)

| ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå             | ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤ (‡∏ï‡∏≤‡∏°‡∏Ñ‡∏•‡∏¥‡∏õ)      | ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà (2025)                         |
| ------------------- | ---------------------- | -------------------------------------- |
| **File Validation** | ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô      | ‡πÉ‡∏ä‡πâ Zod schema validation ‡πÅ‡∏ö‡∏ö custom   |
| **Error Handling**  | Error handling ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ | Try-catch patterns ‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå          |
| **Type Safety**     | TypeScript ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô     | Function overloading + Generic types   |
| **File Storage**    | ‡∏Å‡∏≤‡∏£‡πÄ‡∏ã‡∏ü‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢      | UUID-based folder structure            |
| **Image Preview**   | Preview ‡πÅ‡∏ö‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô     | Real-time preview ‡∏û‡∏£‡πâ‡∏≠‡∏° rounded option |

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå

```
project/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ shared/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ helper/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ file.ts           # ‚ú® ‡πÉ‡∏´‡∏°‡πà: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ upload.ts         # ‚ú® ‡πÉ‡∏´‡∏°‡πà: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô image path
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validator/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ image.ts          # ‚ú® ‡πÉ‡∏´‡∏°‡πà: Zod validation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ components/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ image-uploader.tsx  # ‚ú® ‡πÉ‡∏´‡∏°‡πà: Upload component
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/admin/article/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ route.ts          # üîÑ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: FormData handling
‚îÇ   ‚îî‚îÄ‚îÄ features/admin/article/
‚îÇ       ‚îî‚îÄ‚îÄ components/
‚îÇ           ‚îî‚îÄ‚îÄ article-form.tsx  # üîÑ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: ‡πÄ‡∏û‡∏¥‡πà‡∏° image upload
```

## üîß ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞ Dependencies

```bash
# Dependencies ‡∏´‡∏•‡∏±‡∏Å
npm install zod
npm install @hookform/resolvers
npm install react-hook-form

# TypeScript types (‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
npm install -D @types/node
```

## üìù ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏ö‡∏ö Step-by-Step

### 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå (`file.ts`)

```typescript
// src/shared/helper/file.ts
import { mkdir, writeFile, unlink } from "fs/promises";
import { join } from "path";
import { randomUUID } from "crypto";

/**
 * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ã‡∏ü‡πÑ‡∏ü‡∏•‡πå‡∏•‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
 * @param file - ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ã‡∏ü (File object)
 * @returns Promise<string> - path ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏ü‡πÅ‡∏•‡πâ‡∏ß
 */
export async function saveFile(file: File): Promise<string> {
  // ‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏õ‡πá‡∏ô binary data
  const bytes = await file.arrayBuffer();
  const buffer = Buffer.from(bytes);

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠ folder ‡πÅ‡∏ö‡∏ö random
  const folderName = randomUUID();
  const fileName = file.name;

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á directory structure
  const uploadDir = join("public", "upload", folderName);
  await mkdir(uploadDir, { recursive: true });

  // ‡πÄ‡∏ã‡∏ü‡πÑ‡∏ü‡∏•‡πå
  const filePath = join(uploadDir, fileName);
  await writeFile(filePath, buffer);

  // ‡∏Ñ‡∏∑‡∏ô path ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô database
  return `${folderName}/${fileName}`;
}

/**
 * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå
 * @param path - path ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö
 */
export async function removeFile(path: string): Promise<void> {
  const fullPath = join("public", "upload", path);
  await unlink(fullPath);
}
```

### 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Image Path Helper (`upload.ts`)

```typescript
// src/shared/helper/upload.ts
import { z } from "zod";

/**
 * Function overloading ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö type safety
 */
export function getImagePath(file: string): string;
export function getImagePath(file: null | undefined): undefined;
export function getImagePath(
  file: string | null | undefined
): string | undefined;

/**
 * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á image path ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
 * @param file - ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏£‡∏∑‡∏≠ URL
 * @returns path ‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
 */
export function getImagePath(
  file: string | null | undefined
): string | undefined {
  if (!file) return undefined;

  try {
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô URL ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    z.string().url().parse(file);
    return file; // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô URL ‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°
  } catch {
    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà URL ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏° /upload
    return `/upload/${file}`;
  }
}
```

**üí° ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ Function Overloading:**

```typescript
// ‚úÖ Type-safe: ‡∏ñ‡πâ‡∏≤‡∏™‡πà‡∏á string ‡∏à‡∏∞‡πÑ‡∏î‡πâ string ‡∏Å‡∏•‡∏±‡∏ö
const path1 = getImagePath("image.jpg"); // Type: string

// ‚úÖ Type-safe: ‡∏ñ‡πâ‡∏≤‡∏™‡πà‡∏á null/undefined ‡∏à‡∏∞‡πÑ‡∏î‡πâ undefined ‡∏Å‡∏•‡∏±‡∏ö
const path2 = getImagePath(null); // Type: undefined

// ‚úÖ Type-safe: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏à‡∏∞‡πÑ‡∏î‡πâ string | undefined
const path3 = getImagePath(maybeString); // Type: string | undefined
```

### 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Image Validation (`image.ts`)

```typescript
// src/shared/validator/image.ts
import { z } from "zod";

// ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
const MAX_FILE_SIZE = 1 * 1000 * 1000; // 1MB
const ACCEPTED_IMAGE_TYPES = [
  "image/jpeg",
  "image/jpg",
  "image/png",
  "image/webp",
];

/**
 * Zod schema ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
 */
export const imageValidator = z
  .custom<File | null>(
    (value) => {
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô File object ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
      if (!(value instanceof File)) {
        return false;
      }
      return true;
    },
    {
      message: "Image is required",
    }
  )
  .refine(
    (image) => {
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå
      return image && image.size <= MAX_FILE_SIZE;
    },
    {
      message: `Max file size is 1MB`,
    }
  )
  .refine(
    (image) => {
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏ô‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå
      return image && ACCEPTED_IMAGE_TYPES.includes(image.type);
    },
    {
      message: "Only .jpg, .jpeg, .png and .webp files are accepted",
    }
  );
```

**üîç ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Zod Validation:**

```mermaid
graph TD
    A[File Input] --> B{instanceof File?}
    B -->|No| C[Error: Image is required]
    B -->|Yes| D{Size <= 1MB?}
    D -->|No| E[Error: Max file size is 1MB]
    D -->|Yes| F{Valid image type?}
    F -->|No| G[Error: Only .jpg, .jpeg, .png, .webp allowed]
    F -->|Yes| H[‚úÖ Validation Success]
```

### 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á Image Uploader Component

```typescript
// src/shared/ui/components/image-uploader.tsx
"use client";

import { ChangeEventHandler, useState } from "react";
import Image from "next/image";
import { cn } from "@/lib/utils";

interface ImageUploaderProps {
  defaultImage: string;
  onImageChange: (file: File) => void;
  error?: string;
  rounded?: boolean;
}

export default function ImageUploader({
  defaultImage,
  onImageChange,
  error,
  rounded,
}: ImageUploaderProps) {
  const [image, setImage] = useState(defaultImage);

  const previewImage = (imageFile: File) => {
    setImage(URL.createObjectURL(imageFile));
  };

  const handleImageUpload: ChangeEventHandler<HTMLInputElement> = (event) => {
    const file = event.target.files?.[0];
    if (!file) return;

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á preview
    const imageUrl = URL.createObjectURL(file);
    previewImage(file);

    // ‡∏™‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á parent component
    onImageChange(file);
  };

  return (
    <div className="space-y-4">
      {/* Image Preview */}
      <div className="relative w-24 h-24 mx-auto">
        <Image
          src={image}
          alt="Image Upload Preview"
          fill
          priority
          className={cn(
            "object-cover border-2 border-dashed border-gray-300",
            rounded && "rounded-full"
          )}
        />
      </div>

      {/* Upload Button */}
      <label className="block cursor-pointer">
        <span className="inline-block px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors">
          Select Image
        </span>
        <input
          type="file"
          accept={ACCEPTED_IMAGE_TYPES.join(",")}
          onChange={handleImageUpload}
          className="hidden"
        />
      </label>

      {/* Error Message */}
      {error && <div className="text-red-500 text-sm mt-2">{error}</div>}
    </div>
  );
}
```

**üé® UI Components Breakdown:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    Image Preview        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   [Image Here]  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ   [Select Image Btn]    ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ   ‚ùå Error message      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 5. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Article Form

```typescript
// src/features/admin/article/components/article-form.tsx
"use client";

import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import ImageUploader from "@/shared/ui/components/image-uploader";
import { getImagePath } from "@/shared/helper/upload";

// Types for different form modes
type CreateFormData = AddArticleInput;
type UpdateFormData = UpdateArticleInput;

interface ArticleFormProps {
  onSubmit: (data: CreateFormData | UpdateFormData) => void;
  article?: Article; // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö edit mode
}

export default function ArticleForm({ onSubmit, article }: ArticleFormProps) {
  // Dynamic form type based on mode
  const form = useForm<CreateFormData | UpdateFormData>({
    resolver: zodResolver(article ? updateArticleSchema : addArticleSchema),
    defaultValues: {
      title: article?.title || "",
      excerpt: article?.excerpt || "",
      content: article?.content || "",
      image: undefined, // ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô undefined ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ File object
    },
  });

  const handleImageChange = (file: File) => {
    // Manual set value ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ custom component
    form.setValue("image", file, {
      shouldValidate: true, // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
    });
  };

  return (
    <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-6">
      {/* Image Upload Section */}
      <div>
        <label className="block text-sm font-medium mb-2">Article Image</label>
        <ImageUploader
          defaultImage={
            article?.image
              ? getImagePath(article.image)
              : "/assets/images/no-image.png"
          }
          onImageChange={handleImageChange}
          error={form.formState.errors.image?.message}
          rounded={false}
        />
      </div>

      {/* Other form fields... */}

      <button
        type="submit"
        className="w-full bg-blue-500 text-white py-2 rounded"
      >
        {article ? "Update" : "Create"} Article
      </button>
    </form>
  );
}
```

**üîÑ ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á React Hook Form:**

```mermaid
sequenceDiagram
    participant User
    participant ImageUploader
    participant Form
    participant Validation

    User->>ImageUploader: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
    ImageUploader->>ImageUploader: ‡∏™‡∏£‡πâ‡∏≤‡∏á preview
    ImageUploader->>Form: onImageChange(file)
    Form->>Form: setValue('image', file)
    Form->>Validation: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    Validation-->>Form: ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    Form-->>ImageUploader: ‡πÅ‡∏™‡∏î‡∏á error (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
```

### 6. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï API Route ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö FormData

```typescript
// src/app/api/admin/article/route.ts
import { NextRequest, NextResponse } from "next/server";
import { saveFile } from "@/shared/helper/file";
import { addArticle } from "@/features/admin/article/api";
import { revalidatePath } from "next/cache";

export async function POST(request: NextRequest) {
  try {
    // ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• FormData
    const formData = await request.formData();

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ü‡∏¥‡∏•‡∏î‡πå
    const title = formData.get("title") as string;
    const excerpt = formData.get("excerpt") as string;
    const content = formData.get("content") as string;
    const image = formData.get("image") as File;

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if (!image) {
      return NextResponse.json({ error: "No file uploaded" }, { status: 400 });
    }

    // ‡πÄ‡∏ã‡∏ü‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ path ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
    const savedImagePath = await saveFile(image);

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á article ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    const article = await addArticle({
      title,
      excerpt,
      content,
      image: savedImagePath,
    });

    // Revalidate cache
    revalidatePath("/article");

    return NextResponse.json(article, {
      status: 201,
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    console.error("Article creation error:", error);
    return NextResponse.json(
      { error: "Failed to create article" },
      { status: 500 }
    );
  }
}
```

### 7. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Client-side API Call

```typescript
// src/features/admin/article/api/index.ts
export async function createArticleAPI(formData: AddArticleInput) {
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á FormData object
  const form = new FormData();

  form.append("title", formData.title);
  form.append("excerpt", formData.excerpt);
  form.append("content", formData.content);

  // ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
  if (formData.image) {
    form.append("image", formData.image);
  }

  // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö FormData (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏ Content-Type)
  const response = await fetch("/api/admin/article", {
    method: "POST",
    body: form, // ‚ö†Ô∏è ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà JSON.stringify()
  });

  if (!response.ok) {
    throw new Error("Failed to create article");
  }

  return response.json();
}
```

## üîç ‡∏Å‡∏≤‡∏£ Debug ‡πÅ‡∏•‡∏∞ Testing

### ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Debug

```typescript
// ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô development mode
if (process.env.NODE_ENV === "development") {
  console.log("FormData contents:");
  for (const [key, value] of formData.entries()) {
    console.log(`${key}:`, value);
  }
}
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏ô Browser DevTools

1. **Network Tab** - ‡∏î‡∏π‡∏ß‡πà‡∏≤ request ‡πÄ‡∏õ‡πá‡∏ô `multipart/form-data`
2. **Payload** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÑ‡∏õ
3. **Response** - ‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å server

```
Request Headers:
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary...

Payload:
------WebKitFormBoundary...
Content-Disposition: form-data; name="title"

My Article Title
------WebKitFormBoundary...
Content-Disposition: form-data; name="image"; filename="image.jpg"
Content-Type: image/jpeg

[binary data]
```

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

### 1. TypeScript Type Issues

```typescript
// ‚ùå ‡∏ú‡∏¥‡∏î: File type ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö string
const form = useForm<{ image: string }>(); // ‡∏ú‡∏¥‡∏î!

// ‚úÖ ‡∏ñ‡∏π‡∏Å: ‡πÉ‡∏ä‡πâ File type ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö upload
const form = useForm<{ image: File | undefined }>();
```

### 2. FormData vs JSON

```typescript
// ‚ùå ‡∏ú‡∏¥‡∏î: ‡∏™‡πà‡∏á File ‡πÄ‡∏õ‡πá‡∏ô JSON
fetch("/api", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ image: file }), // ‚ùå ‡∏ó‡∏≥‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ!
});

// ‚úÖ ‡∏ñ‡∏π‡∏Å: ‡πÉ‡∏ä‡πâ FormData
const formData = new FormData();
formData.append("image", file);
fetch("/api", {
  method: "POST",
  body: formData, // ‚úÖ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏ Content-Type
});
```

### 3. Path Resolution

```typescript
// ‚ùå ‡∏ú‡∏¥‡∏î: Missing /upload prefix
<Image src={article.image} /> // ‚ùå ‡∏à‡∏∞‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠

// ‚úÖ ‡∏ñ‡∏π‡∏Å: ‡πÉ‡∏ä‡πâ helper function
<Image src={getImagePath(article.image)} />
```

## üöÄ ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï

### 1. Image Optimization

- ‡πÉ‡∏ä‡πâ Sharp.js ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö resize ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
- ‡∏™‡∏£‡πâ‡∏≤‡∏á multiple sizes (thumbnails)
- WebP conversion ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

### 2. Cloud Storage Integration

- AWS S3 / Cloudinary integration
- CDN ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö performance
- Progressive loading

### 3. Advanced Validation

- AI-powered content moderation
- Duplicate image detection
- Metadata extraction

## üìö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- [Next.js File Upload Documentation](https://nextjs.org/docs/app/building-your-application/routing/route-handlers#request-body)
- [Zod Validation](https://zod.dev/)
- [React Hook Form](https://react-hook-form.com/)
- [MDN FormData API](https://developer.mozilla.org/en-US/docs/Web/API/FormData)

---

**üìù ‡∏™‡∏£‡∏∏‡∏õ:** ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô Next.js 15.3.2 ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á type safety, validation, ‡πÅ‡∏•‡∏∞ error handling ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
